/home/chen4433/.conda/envs/2025.06-py313/opt-ml-env/lib/python3.12/site-packages/torch/functional.py:554: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4322.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
config_root: ./cfg
resume_model_dir: 
model_suffix: 
model_dir: ./models
log_dir: ./logs
model: raw
hidden_channels: 64
num_layers: 2
n_breakings: 8
num_heads: 1
isab_num_inds: 50
sym_break_layers: 2
mp_layers: 2
use_set_transformer: True
breaking_selector_model_path: None
edge_nfeats: 1
binarize_edge_features: False
file_pattern: sample_*.pkl
seed: 42
epochs: 2
lr: 0.0001
batch_size: 8
weight_decay: 0.0005
loss_option: ranking
resume: False
eval_every: 10000
save_every: 10000
print_every: 10000
dataset_path: legacy_code_generator/data/samples/setcover/500r_1000c_0.05d
dataset: set_cover
cfg_idx: 0
model_id: set_cover_cfg0
device: cuda
load dataset from legacy_code_generator/data/samples/setcover/500r_1000c_0.05d
Model is saved to models/raw/set_cover_cfg0, logs are saved to logs/set_cover_cfg0.
[Epoch 1] CPU Memory - RSS: 0.92 GB
-------------------------------------------- Evaluating at epoch 1, step 0 ---------------------------------------------
-------- Valid loss: 4.791, accuracy 0.035, top 5 accuracy 0.170, score difference [abs] 5.995 [relative] 0.918 --------
Saved checkpoint models/raw/set_cover_cfg0/0.pth
------------------------------------------ Evaluating at epoch 1, step 10000 -------------------------------------------
-------- Valid loss: 3.083, accuracy 0.587, top 5 accuracy 0.868, score difference [abs] 1.155 [relative] 0.129 --------
Saved checkpoint models/raw/set_cover_cfg0/10000.pth
Step 10000: Train loss 48.687, accuracy 0.546, Top-5 accuracy 0.814, [absolute] 1.481 [relative] 0.164
Epoch 1: Train loss 48.491, accuracy 0.556, top 5 accuracy 0.825, [absolute] 1.408 [relative] 0.157
[Epoch 2] CPU Memory - RSS: 1.85 GB
------------------------------------------ Evaluating at epoch 2, step 20000 -------------------------------------------
-------- Valid loss: 3.068, accuracy 0.607, top 5 accuracy 0.887, score difference [abs] 1.032 [relative] 0.117 --------
Saved checkpoint models/raw/set_cover_cfg0/20000.pth
Step 20000: Train loss 47.502, accuracy 0.608, Top-5 accuracy 0.880, [absolute] 1.068 [relative] 0.119
Epoch 2: Train loss 47.436, accuracy 0.609, top 5 accuracy 0.885, [absolute] 1.052 [relative] 0.117
Saved checkpoint models/raw/set_cover_cfg0/25000.pth
Training completed in 87.34 minutes.
config_root: ./cfg
resume_model_dir: 
model_suffix: 
model_dir: ./models
log_dir: ./logs
model: raw
hidden_channels: 64
num_layers: 2
n_breakings: 8
num_heads: 1
isab_num_inds: 50
sym_break_layers: 2
mp_layers: 2
use_set_transformer: True
breaking_selector_model_path: None
edge_nfeats: 1
binarize_edge_features: False
file_pattern: sample_*.pkl
seed: 42
epochs: 2
lr: 0.0001
batch_size: 8
weight_decay: 0.0005
loss_option: ranking
resume: False
eval_every: 100000
save_every: 100000
print_every: 100000
dataset_path: legacy_code_generator/data/samples/setcover/500r_1000c_0.05d
dataset: set_cover
cfg_idx: 0
parent_test_stats_dir: data/results_summary/
eval_split: test
eval_batch_size: 32
eval_train_batch_size: None
eval_val_batch_size: None
eval_test_batch_size: None
model_id: set_cover_cfg0
device: cuda
load dataset from legacy_code_generator/data/samples/setcover/500r_1000c_0.05d
Number of parameters: 115196
Loaded checkpoint models/raw/set_cover_cfg0/25000.pth
---------------------------- [test] Save stats to: data/results_summary/set_cover_cfg0/test ----------------------------
[test] loss 3.0200, acc 0.6173, top5 0.8887, score_diff 0.9561, normalized 0.1102
Total eval time: 8.10 minutes
** cauctions dataset **
/home/chen4433/.conda/envs/2025.06-py313/opt-ml-env/lib/python3.12/site-packages/torch/functional.py:554: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4322.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
config_root: ./cfg
resume_model_dir: 
model_suffix: 
model_dir: ./models
log_dir: ./logs
model: raw
hidden_channels: 64
num_layers: 2
n_breakings: 8
num_heads: 1
isab_num_inds: 50
sym_break_layers: 2
mp_layers: 2
use_set_transformer: True
breaking_selector_model_path: None
edge_nfeats: 1
binarize_edge_features: False
file_pattern: sample_*.pkl
seed: 42
epochs: 2
lr: 0.0001
batch_size: 8
weight_decay: 0.0005
loss_option: ranking
resume: False
eval_every: 10000
save_every: 10000
print_every: 10000
dataset_path: legacy_code_generator/data/samples/cauctions/100_500
dataset: cauctions
cfg_idx: 0
model_id: cauctions_cfg0
device: cuda
load dataset from legacy_code_generator/data/samples/cauctions/100_500
Model is saved to models/raw/cauctions_cfg0, logs are saved to logs/cauctions_cfg0.
[Epoch 1] CPU Memory - RSS: 0.93 GB
-------------------------------------------- Evaluating at epoch 1, step 0 ---------------------------------------------
------ Valid loss: 4.810, accuracy 0.120, top 5 accuracy 0.406, score difference [abs] 1093.231 [relative] 0.761 -------
Saved checkpoint models/raw/cauctions_cfg0/0.pth
------------------------------------------ Evaluating at epoch 1, step 10000 -------------------------------------------
------- Valid loss: 2.760, accuracy 0.590, top 5 accuracy 0.887, score difference [abs] 263.896 [relative] 0.152 -------
Saved checkpoint models/raw/cauctions_cfg0/10000.pth
Step 10000: Train loss 32.175, accuracy 0.580, Top-5 accuracy 0.872, [absolute] 290.884 [relative] 0.162
Epoch 1: Train loss 32.028, accuracy 0.583, top 5 accuracy 0.876, [absolute] 284.365 [relative] 0.159
[Epoch 2] CPU Memory - RSS: 1.85 GB
------------------------------------------ Evaluating at epoch 2, step 20000 -------------------------------------------
------- Valid loss: 2.740, accuracy 0.597, top 5 accuracy 0.890, score difference [abs] 252.271 [relative] 0.144 -------
Saved checkpoint models/raw/cauctions_cfg0/20000.pth
Step 20000: Train loss 31.359, accuracy 0.601, Top-5 accuracy 0.892, [absolute] 258.898 [relative] 0.145
Epoch 2: Train loss 31.325, accuracy 0.602, top 5 accuracy 0.891, [absolute] 257.460 [relative] 0.144
Saved checkpoint models/raw/cauctions_cfg0/25000.pth
Training completed in 70.90 minutes.
config_root: ./cfg
resume_model_dir: 
model_suffix: 
model_dir: ./models
log_dir: ./logs
model: raw
hidden_channels: 64
num_layers: 2
n_breakings: 8
num_heads: 1
isab_num_inds: 50
sym_break_layers: 2
mp_layers: 2
use_set_transformer: True
breaking_selector_model_path: None
edge_nfeats: 1
binarize_edge_features: False
file_pattern: sample_*.pkl
seed: 42
epochs: 2
lr: 0.0001
batch_size: 8
weight_decay: 0.0005
loss_option: ranking
resume: False
eval_every: 100000
save_every: 100000
print_every: 100000
dataset_path: legacy_code_generator/data/samples/cauctions/100_500
dataset: cauctions
cfg_idx: 0
parent_test_stats_dir: data/results_summary/
eval_split: test
eval_batch_size: 32
eval_train_batch_size: None
eval_val_batch_size: None
eval_test_batch_size: None
model_id: cauctions_cfg0
device: cuda
load dataset from legacy_code_generator/data/samples/cauctions/100_500
Number of parameters: 115196
Loaded checkpoint models/raw/cauctions_cfg0/25000.pth
---------------------------- [test] Save stats to: data/results_summary/cauctions_cfg0/test ----------------------------
[test] loss 2.7478, acc 0.6065, top5 0.8982, score_diff 252.6940, normalized 0.1404
Total eval time: 11.78 minutes
** facilities dataset **
/home/chen4433/.conda/envs/2025.06-py313/opt-ml-env/lib/python3.12/site-packages/torch/functional.py:554: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4322.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
config_root: ./cfg
resume_model_dir: 
model_suffix: 
model_dir: ./models
log_dir: ./logs
model: raw
hidden_channels: 64
num_layers: 2
n_breakings: 8
num_heads: 1
isab_num_inds: 50
sym_break_layers: 2
mp_layers: 2
use_set_transformer: True
breaking_selector_model_path: None
edge_nfeats: 1
binarize_edge_features: False
file_pattern: sample_*.pkl
seed: 42
epochs: 2
lr: 0.0001
batch_size: 8
weight_decay: 0.0005
loss_option: ranking
resume: False
eval_every: 10000
save_every: 10000
print_every: 10000
dataset_path: legacy_code_generator/data/samples/facilities/100_100_5
dataset: facilities
cfg_idx: 0
model_id: facilities_cfg0
device: cuda
load dataset from legacy_code_generator/data/samples/facilities/100_100_5
Model is saved to models/raw/facilities_cfg0, logs are saved to logs/facilities_cfg0.
[Epoch 1] CPU Memory - RSS: 0.93 GB
-------------------------------------------- Evaluating at epoch 1, step 0 ---------------------------------------------
------- Valid loss: 3.610, accuracy 0.105, top 5 accuracy 0.533, score difference [abs] 185.713 [relative] 0.880 -------
Saved checkpoint models/raw/facilities_cfg0/0.pth
------------------------------------------ Evaluating at epoch 1, step 10000 -------------------------------------------
------- Valid loss: 0.909, accuracy 0.691, top 5 accuracy 0.985, score difference [abs] 41.986 [relative] 0.167 --------
Saved checkpoint models/raw/facilities_cfg0/10000.pth
Step 10000: Train loss 3.146, accuracy 0.668, Top-5 accuracy 0.968, [absolute] 46.180 [relative] 0.188
Epoch 1: Train loss 3.120, accuracy 0.673, top 5 accuracy 0.970, [absolute] 45.129 [relative] 0.183
[Epoch 2] CPU Memory - RSS: 1.90 GB
------------------------------------------ Evaluating at epoch 2, step 20000 -------------------------------------------
------- Valid loss: 0.912, accuracy 0.694, top 5 accuracy 0.985, score difference [abs] 40.664 [relative] 0.165 --------
Saved checkpoint models/raw/facilities_cfg0/20000.pth
Step 20000: Train loss 3.016, accuracy 0.694, Top-5 accuracy 0.981, [absolute] 39.899 [relative] 0.163
Epoch 2: Train loss 3.013, accuracy 0.696, top 5 accuracy 0.982, [absolute] 39.536 [relative] 0.162
Saved checkpoint models/raw/facilities_cfg0/25000.pth
Training completed in 258.87 minutes.
config_root: ./cfg
resume_model_dir: 
model_suffix: 
model_dir: ./models
log_dir: ./logs
model: raw
hidden_channels: 64
num_layers: 2
n_breakings: 8
num_heads: 1
isab_num_inds: 50
sym_break_layers: 2
mp_layers: 2
use_set_transformer: True
breaking_selector_model_path: None
edge_nfeats: 1
binarize_edge_features: False
file_pattern: sample_*.pkl
seed: 42
epochs: 2
lr: 0.0001
batch_size: 8
weight_decay: 0.0005
loss_option: ranking
resume: False
eval_every: 100000
save_every: 100000
print_every: 100000
dataset_path: legacy_code_generator/data/samples/facilities/100_100_5
dataset: facilities
cfg_idx: 0
parent_test_stats_dir: data/results_summary/
eval_split: test
eval_batch_size: 32
eval_train_batch_size: None
eval_val_batch_size: None
eval_test_batch_size: None
model_id: facilities_cfg0
device: cuda
load dataset from legacy_code_generator/data/samples/facilities/100_100_5
Number of parameters: 115196
Loaded checkpoint models/raw/facilities_cfg0/25000.pth
--------------------------- [test] Save stats to: data/results_summary/facilities_cfg0/test ----------------------------
[test] loss 0.9416, acc 0.6883, top5 0.9822, score_diff 40.4353, normalized 0.1640
Total eval time: 18.60 minutes
** indset dataset **
/home/chen4433/.conda/envs/2025.06-py313/opt-ml-env/lib/python3.12/site-packages/torch/functional.py:554: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4322.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
config_root: ./cfg
resume_model_dir: 
model_suffix: 
model_dir: ./models
log_dir: ./logs
model: raw
hidden_channels: 64
num_layers: 2
n_breakings: 8
num_heads: 1
isab_num_inds: 50
sym_break_layers: 2
mp_layers: 2
use_set_transformer: True
breaking_selector_model_path: None
edge_nfeats: 1
binarize_edge_features: False
file_pattern: sample_*.pkl
seed: 42
epochs: 2
lr: 0.0001
batch_size: 8
weight_decay: 0.0005
loss_option: ranking
resume: False
eval_every: 10000
save_every: 10000
print_every: 10000
dataset_path: legacy_code_generator/data/samples/indset/500_4
dataset: indset
cfg_idx: 0
model_id: indset_cfg0
device: cuda
load dataset from legacy_code_generator/data/samples/indset/500_4
Model is saved to models/raw/indset_cfg0, logs are saved to logs/indset_cfg0.
[Epoch 1] CPU Memory - RSS: 0.92 GB
-------------------------------------------- Evaluating at epoch 1, step 0 ---------------------------------------------
-------- Valid loss: 6.144, accuracy 0.097, top 5 accuracy 0.248, score difference [abs] 0.439 [relative] 0.757 --------
Saved checkpoint models/raw/indset_cfg0/0.pth
------------------------------------------ Evaluating at epoch 1, step 10000 -------------------------------------------
-------- Valid loss: 5.048, accuracy 0.516, top 5 accuracy 0.733, score difference [abs] 0.090 [relative] 0.115 --------
Saved checkpoint models/raw/indset_cfg0/10000.pth
Step 10000: Train loss 317.457, accuracy 0.478, Top-5 accuracy 0.670, [absolute] 0.125 [relative] 0.154
Epoch 1: Train loss 316.523, accuracy 0.486, top 5 accuracy 0.683, [absolute] 0.119 [relative] 0.146
[Epoch 2] CPU Memory - RSS: 1.84 GB
------------------------------------------ Evaluating at epoch 2, step 20000 -------------------------------------------
-------- Valid loss: 5.044, accuracy 0.531, top 5 accuracy 0.750, score difference [abs] 0.087 [relative] 0.108 --------
Saved checkpoint models/raw/indset_cfg0/20000.pth
Step 20000: Train loss 311.818, accuracy 0.527, Top-5 accuracy 0.744, [absolute] 0.088 [relative] 0.111
Epoch 2: Train loss 311.485, accuracy 0.531, top 5 accuracy 0.747, [absolute] 0.087 [relative] 0.109
Saved checkpoint models/raw/indset_cfg0/25000.pth
Training completed in 69.02 minutes.
config_root: ./cfg
resume_model_dir: 
model_suffix: 
model_dir: ./models
log_dir: ./logs
model: raw
hidden_channels: 64
num_layers: 2
n_breakings: 8
num_heads: 1
isab_num_inds: 50
sym_break_layers: 2
mp_layers: 2
use_set_transformer: True
breaking_selector_model_path: None
edge_nfeats: 1
binarize_edge_features: False
file_pattern: sample_*.pkl
seed: 42
epochs: 2
lr: 0.0001
batch_size: 8
weight_decay: 0.0005
loss_option: ranking
resume: False
eval_every: 100000
save_every: 100000
print_every: 100000
dataset_path: legacy_code_generator/data/samples/indset/500_4
dataset: indset
cfg_idx: 0
parent_test_stats_dir: data/results_summary/
eval_split: test
eval_batch_size: 32
eval_train_batch_size: None
eval_val_batch_size: None
eval_test_batch_size: None
model_id: indset_cfg0
device: cuda
load dataset from legacy_code_generator/data/samples/indset/500_4
Number of parameters: 115196
Loaded checkpoint models/raw/indset_cfg0/25000.pth
----------------------------- [test] Save stats to: data/results_summary/indset_cfg0/test ------------------------------
[test] loss 5.0809, acc 0.5554, top5 0.7620, score_diff 0.0871, normalized 0.0997
Total eval time: 7.93 minutes
